#! /usr/bin/python3

import requests
import shutil, os
import zipfile

challenge_url = "http://www.pythonchallenge.com/pc/def/channel.html"

# Points to get a zip
challenge = requests.get(challenge_url)

# Gets a zip file
challenge_zip = requests.get(challenge_url[:-4]+"zip")
with open("channel.zip", "wb") as f:
    f.write(challenge_zip.content)

# unzip into a directory
with zipfile.ZipFile("channel.zip", "r") as zip_f:
    zip_f.extractall("./channel")

# Get list of files in order as per Readme
# starting with 90052.txt
file_list = ["90052.txt"]

while 1:
    with open("channel/"+file_list[-1], "r") as f:
        print(f"File {file_list[-1]}")
        file_words_list = f.read().split()
        if len(file_words_list) != 4:
            print(" ".join(file_words_list))
            break
        next_file = file_words_list[-1]+".txt"
        file_list.append(next_file)

# Last file says to collect 'comments'

# Get comments of each file in file_list
comments = []
with zipfile.ZipFile("channel.zip", "r") as zip_f:
    for file in file_list:
        comments.append(zip_f.getinfo(file).comment.decode())

shutil.rmtree("channel")
os.remove("channel.zip")
comments = "".join(comments)
print(f"Solution Text:\n {comments}")

# solution text is hockey
solution_text = "hockey"
print(f"Solution URL:", challenge_url[:-12]+solution_text+".html")

# the word hockey is written using the letters "oxygen"
solution_text = "oxygen"
print(f"Solution URL:", challenge_url[:-12]+solution_text+".html")
