import requests
import bs4
import base64

# url to connect to
url = "http://natas8.natas.labs.overthewire.org/"

# creds
username = "natas8"
passwd = "DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe"

# encoded string from source
enc = "3d3d516343746d4d6d6c315669563362"

# creating base64 encoded string by decoding hex to ascii
enc = [chr(int(enc[i-1]+enc[i], 16)) for i in range(1, len(enc), 2)]

# reversing
enc = "".join(enc)[::-1]

# base64 decoding
enc = base64.b64decode(enc).decode()

print("decoded secret:", enc)

# Natas usually has a div with id='content' containing the content
def get_content(res):
    output = bs4.BeautifulSoup(res.text, "lxml").find_all(id="content")[0].get_text().strip()
    return output

data = {"secret": enc, "submit": 1}

response = requests.post(url, auth=(username, passwd), data=data)
if response.status_code == requests.codes.ok:
    print(get_content(response))
else:
    print(response.status_code)



